---
layout: post
title: コードカバレッジにテストケース分も含むべきか？
date: '2013-04-25T22:51:00.001+09:00'
author: ソフトウェア開発にまつわる話
tags:
modified_time: '2013-04-25T22:51:32.463+09:00'
blogger_id: tag:blogger.com,1999:blog-469434601551305913.post-2695958299566756109
blogger_orig_url: https://two-pack-sbs.blogspot.com/2013/04/blog-post.html
---

<a href="http://two-pack-sbs.blogspot.jp/2013/04/jacoco-maven-plugin.html">JaCoCO Maven Pluginでテストケースのカバレッジもとる</a>の後、パッチを書いて<a href="https://github.com/jacoco/jacoco/pull/94">pull request</a>を出しました。<br />
結論から言うと、一旦取り下げました。<br />
<br />
作ったパッチは、<br />
<br />
<ul>
<li>mavenでJUnitのテストを実行した際に、テストのオブジェクトファイルができる場所（例えばtest-classes）をカバレッジ対象に加える</li>
</ul>
<br />
というものです。前のブログで書いたような結果が得られます。<br />
しかし、以下のような点からデフォルトで含むのはどうなの？という意見がでました。<br />
<br />
<ol>
<li>あまりコードカバレッジにテストケース分を含むのは一般的じゃないんじゃない？</li>
<li>だって、プロダクションコードのカバレッジと混ざって、ほんとのカバレッジが見づらくなるじゃん？</li>
<li>EclipseのプラグインであるEclEMMAの場合は、テストコードの場所に決まりが無いから全部にしてるんだよね。<br />＃やばい、closeした時、誤訳してたと書いてて気づいた。。。</li>
<li>少なくともデフォルトは出さない方がいいよね。</li>
</ol>
<br />
１は、普通フォルダだったりパッケージだったりを分けるんじゃないかな？と思います。<br />
カバレッジもそれぞれで分けて表示できると思うので、問題にならないんじゃないかな、と。<br />
２は、１のように分けていなければ、その通りだと思います。<br />
<br />
そもそもパッチを書いた理由は、テストケースのカバレッジも見えるべきじゃない？ということでした。<br />
他の意見としても、デフォルトは出さずオプションで選択できるようにしたらいいんじゃない？というものでした。<br />
Maven pluginの形をとるという事は、いろんなケースがありえる前提に立って２のようなことを避ける方に倒すべきかな、と考え直し取り下げました。<br />
オプション形式に書き直そうと思ってます。<br />
<br />
で、JaCoCo Maven Pluginではパッケージで階層化されたレポート出力になるので、混ざらないように書いておくのが良いのかな？<br />
ベストプラクティスとかあるんですかね？